# BootKMeans

## Overview and motivation

As many other Machine Learning algorithms, K-Means is sensitive to the training data, overall for small datasets. In this sense, different samples drawn from the same population
will result in different centroids positions and, accordingly, different clustering boundaries and cluster membership (labels) assignments in future observations (test set). 
This means that the predictions of the K-means model are subjected to uncertainties that could be critical. For example, assigning a new client to the wrong customer segment
 is not a desirable policy. An elegant way of estimating these uncertainties is to use a Bootstrap resampling technique.
In this procedure, a large number *B* of new samples (bootstrap replicas) are generated by randomly sampling with replacement *n* observations from the *n* available ones.
For each bootstrap replica, a K-Means model is fitted. This will result in a distribution of centroids locations. From this distribution, one could obtain an estimate of the 
confidence intervals for the centroids (skipped in this implementation), or the probability of a new observation to belong to a given cluster (done in this implementation). 

`BootKMeans` is an Sklearn-type class that uses bootstrap resampling onto K Means clustering to obtain an estimate of the uncertainties in the cluster membership, centroids, and boundaries. 
As such, it can be combined with pipelines to preprocess the training data.

## Dependencies

BootKMeans requires sci-kit learn 1.0 and all its dependencies

## Installation

* Clone this repository to your local machine

```
$ git clone https://github.com/lucerlab/BootKMeans
```

* Do you want to make it `pip`-installable? Go ahead and feel free to contribute.

## Parameters and attributes

**Parameters**   
* n_boot: int, default = 999
   - Number of bootstrap replicas to generate        
* n_clusters, init, n_init, max_iter, tol, verbose, random_state, copy_x, algorithm:
   - The same as [sklearn K-Means](https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html)

**Attributes**   
* cluster_centers_ : ndarray of shape (n_clusters, n_features)
  - Coordinates of cluster centers (for full dataset).         
* labels_ : ndarray of shape (n_samples,)
  - Labels of each point (for full dataset).
* inertia_ : float
  - Sum of squared distances of samples to their closest cluster center,
	weighted by the sample weights if provided  (for full dataset).
* n_iter_ : int
  - Number of iterations run  (for full dataset).
* n_features_in_ : int
  - Number of features seen during :term:`fit`  (for full dataset).


* cluster_centers_boot_ : ndarray of shape (n_clusters, n_features, n_boot)
  - Coordinates of cluster centers for each bootstrap replica model.
* labels_boot_ : ndarray of shape (n_samples, n_boot)
  - Labels of each point for each bootstrap replica model.
* labels_boot_prob_ : ndarray of shape (n_samples, n_clusters)
  - Probabilities of each point to belong to the different clusters. The probability
	is given by the number of times a point belongs to the given cluster divided by
	n_boot.
* inertia_boot_ : ndarray of shape (n_boot,)
  - Sum of squared distances of samples to their closest cluster center for each
	bootstrap replica, weighted by the sample weights if provided.